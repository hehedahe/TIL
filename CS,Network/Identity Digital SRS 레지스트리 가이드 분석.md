## Getting Started

### **2.9 XML 메세지 구조**

- `<?xml?>`: XML 버전과 문자셋을 지정하여 선언합니다.

- `<epp></epp>`: 이 태그 안에 EPP 명령문

``` xml
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<epp xmlns="urn:ietf:params:xml:ns:epp-1.0">
<command>
...valid EPP commands..
</command>
</epp>
```

### **2.10 EPP 명령문**
#### **1. session 관리**
클라이언트와 서버간의 EPP 세션을 시작하고 종료하는데 사용합니다.

| **명령문**      | **설명**                                                         |
| ------------ | -------------------------------------------------------------- |
| **hello**    | 클라이언트가 서버가 가능한지 확인하기 위함이다.                                     |
| **greeting** | 명령문이라기보다 클라이언트의 `<hello>` 요청에 대한 서비스 제공에 대한 정보가 담겨있는 서버의 응답이다. |
| **login**    | 클라이언트는 서버와 세션을 시작한다. 세션이 설정되면 서버와 지속적으로 데이터를 주고 받을 수 있다.       |
| **logout**   | 클라이언트 서버와 세션을 종료한다.                                            |
  
  
#### **2. 조회**
  
| **명령문**      | **설명**                                                        |
| ------------ | ------------------------------------------------------------- |
| **check**    | 레지스트리 객체를 프로비저닝, 즉 레지스트리 DB에 등록하고 설정하려는 시도의 결과를 예측하는 데 사용된다.  |
| **info**     | 클라이언트가 레지스트리 객체와 관련된 정보를 조회한다. 리턴되는 정보의 양은 객체와 그 권한에 따라 달라진다. |
| **poll**     | 클라이언트가 서버에게 받은 메세지 목록을 조회한다.                                  |
| **transfer** | 클라이언트가 전송 작업 상태를 조회한다.                                        |
  
    
#### **3. 객체 변환**
    
| **명령문**      | **설명**                                              |
| ------------ | --------------------------------------------------- |
| **create**   | 클라이언트가 SRS DB에 새로운 객체를 생성한다.                        |
| **delete**   | 클라이언트가 DB에서 객체를 삭제한다.                               |
| **renew**    | 클라이언트가 도메인 이름 객체의 만료 기간을 연장한다.                      |
| **transfer** | 레지스트리 객체의 소유를 이전하거나 이전에 대해 승인 또는 거절한다.              |
| **update**   | 클라이언트가 도메인 이름에 새 연락처 추가와 같은 레지스트리 객체와 관련된 정보를 변경한다. |
  
    
  
---
## **3 TLD Status**
  
아래는 도메인 라이프 사이클이다.
![도메인 생애주기](https://i.imgur.com/cVo5xUI.png)
  
### **3.1 TLD Process**

- Check domain
- Create domain
- Renew domain
- Transfer domain
- Delete domain

Page 22 ~ 31의 그림을 참고해볼 것


### EPP Domain Status
  
참고: [RFC 5731](https://datatracker.ietf.org/doc/html/rfc5731#autoid-7)  

도메인 객체는 적어도 하나의 연관된 상태를 가져야만 한다.  
  
클라이언트가 추가하거나 제거할 수 있는 상태값은 `client`로 시작한다.
서버가 추가하거나 제거할 수 있는 상태값은 `server`로 시작하거나  `client`나 server로 시작하지 않는 상태값은 서버에서 관리한다.
클라이언트는 서버에서 설정한 상태 값을 변경해서는 안된다. 

#### Status 종류

- `ok`: 보류중인 작업이 아니거나 제한 상태가 아닌 일반적인 상태값이다. 이 상태는 다른 상태 값들이 추가되거나 삭제될 때 서버에 의해 제거되거나 적용될 수 있다.
- `inactive`: 도메인 위임 정보가 연결되어 있지 않다. 이 상태는 도메인이 처음 생성될 때 디폴트 상태이고, DNS 위임을 위한 호스트 객체가 없을 때 적용된다. 또한, 모든 호스트 객체 연결이 제거될 때 서버가 설정할 수 있다.
- `pendingCreate`, `pendingDelete`, `pendingRenew`, `pendingTransfer`, `pendingUpdate`: 도메인 객체에 대한 변환 명령이 처리되었지만, 서버에서 작업이 아직 완료되지 않은 상태이다. 서버 운영자는 다양한 이유로 완료를 지연시킬 수 있다. 예를 들어, 인간?검토나 제3자의 작업을 허용하기 위함 등이 있다. 
  처리되었지만 요청된 작업이 펜딩 중인 변환 명령은 응답코드 **1001**로 표시된다. 
  요청 작업이 완료되면 해당 상태 값은 반드시 제거되어야 한다. 트랜잭션에 관련된 모든 클라이언트들은 서비스 메세지를 사용해 작업이 완료되었고 도메인 상태가 변경되었음을 안내 받아야 한다.  

아래는 제한 상태들이다.
- `clientDeleteProhibited`, `serverDeleteProhibited`: 도메인 삭제 요청이 거절되어야 한다.
- `clientHold`, `serverHold`: DNS 위임 정보는 공개되어서는 안된다.
- `clientRenewProhibited`, `serverRenewProhibited`: 도메인 갱신 요청이 거절되어야 한다.
- `clientTransferProhibited`, `serverTransferProhibited`: 도메인 이전 요청이 거절되어야 한다.
- `clientUpdateProhibited`, `serverUpdateProhibited`: ← 이 상태를 제거하려는 것은 제외하고 도메인 업데이트 요청이 거절되어야 한다.

#### 결합이 불가능한 상태 조합

다음은 결합이 불가능한 상태들의 설명이다. 명시적으로 금지되지않은 조합은 사용 가능하다.  

![](https://i.imgur.com/IaCeLh0.png)


### EPP Host Status
  
참고: [RFC 5732](https://datatracker.ietf.org/doc/html/rfc5732#autoid-7)  

호스트 객체는 적어도 하나의 연관된 상태를 가져야만 한다.  
  
상태값은 호스트 객체를 후원하는 클라이언트와 객체가 위치한 서버에서만 설정할 수 있다.
클라이언트는 EPP `<update>`명령을 사용하여 호스트 객체의 상태를 변경할 수 있다. 하지만 서버에서 설정한 상태는 변경할 수 없다. 
서버는 로컬 서버 정책에 따라 클라이언트가 설정한 상태를 변경하거나 재정의할 수 있다. 호스트 상태는 클라이언트가 시작한 변환 명령이나 서버 운영자가 수행한 작업의 결과로 변경될 수 있다.

#### Status 종류

- `linked`: 호스트 객체는 도메인 객체와 같은 또 다른 객체와 적어도 하나의 활성된 연결을 가지고 있다.
- `ok`: 보류중인 작업이 아니거나 제한이 없는 호스트 객체에 대한 일반적인 상태이다. 이 상태 값은 다른 상태들이 추가되거나 삭제될 때 서버에 의해 설정되거나 삭제된다.
- `pendingCreate`, `pendingDelete`, `pendingTransfer`, `pendingUpdate`: 객체에 대한 변환 명령이 처리되었거나 또는 호스트 객체의 상위 도메인 객체에 대해 `<transfer>` 명령이 처리되었지만, 서버에서 작업이 아직 완료되지 않은 상태이다. 서버 운영자는 다양한 이유로 완료를 지연시킬 수 있다. 예를 들어, 인간?검토나 제3자의 작업을 허용하기 위함 등이 있다. 
  처리되었지만 요청된 작업이 펜딩 중인 변환 명령은 응답코드 **1001**로 표시된다. 
  요청 작업이 완료되면 해당 상태 값은 반드시 제거되어야 한다. 트랜잭션에 관련된 모든 클라이언트들은 서비스 메세지를 사용해 작업이 완료되었고 도메인 상태가 변경되었음을 안내 받아야 한다.  
- `clientDeleteProhibited`, `serverDeleteProhibited`: 호스트 삭제 요청이 거절되어야 한다.
- `clientUpdateProhibited`, `serverUpdateProhibited`: ← 이 상태를 제거하는 것은 제외하고 호스트 업데이트 요청이 거절되어야 한다.  
  
#### 상태 별 결합

다음은 상태 결합에 대한 케이스이다. EPP 도메인 상태와 같이 명시적으로 금지되지않은 조합은 사용 가능하다.  

![](https://i.imgur.com/yp61PGR.png)
  
  
  
### EPP Contact Status
  
참고: [RFC 5733](https://datatracker.ietf.org/doc/html/rfc5733#autoid-5)  

컨택트 객체는 적어도 하나의 연관된 상태를 가져야만 한다.  
  
상태값은 호스트 객체를 후원하는 클라이언트와 객체가 위치한 서버에서만 설정할 수 있다.
클라이언트는 EPP `<update>`명령을 사용하여 호스트 객체의 상태를 변경할 수 있다.
서버에서 설정한 상태는 변경할 수 없다.  서버는 로컬 서버 정책에 따라 클라이언트가 설정한 상태를 변경하거나 재정의할 수 있다. 호스트 상태는 클라이언트가 시작한 변환 명령이나 서버 운영자가 수행한 작업의 결과로 변경될 수 있다.  
  
클라이언트가 추가하거나 제거할 수 있는 상태값은 `client`로 시작한다.
서버가 추가하거나 제거할 수 있는 상태값은 `server`로 시작하거나  `client`나 server로 시작하지 않는 상태값은 서버에서 관리한다.
클라이언트는 서버에서 설정한 상태 값을 변경해서는 안된다. 

#### Status 종류

- `linked`: 컨택트 객체는 도메인 객체와 같은 또 다른 객체와 적어도 하나의 활성된 연결을 가지고 있다.
- `ok`: 보류중인 작업이 아니거나 제한이 없는 객체에 대한 일반적인 상태이다. 이 상태 값은 다른 상태들이 추가되거나 삭제될 때 서버에 의해 설정되거나 삭제된다.
- `pendingCreate`, `pendingDelete`, `pendingTransfer`, `pendingUpdate`: 객체에 대한 변환 명령이 처리되었지만, 서버에서 작업이 아직 완료되지 않은 상태이다. 서버 운영자는 다양한 이유로 완료를 지연시킬 수 있다. 예를 들어, 인간?검토나 제3자의 작업을 허용하기 위함 등이 있다. 
  처리되었지만 요청된 작업이 펜딩 중인 변환 명령은 응답코드 **1001**로 표시된다. 
  요청 작업이 완료되면 해당 상태 값은 반드시 제거되어야 한다. 트랜잭션에 관련된 모든 클라이언트들은 서비스 메세지를 사용해 작업이 완료되었고 도메인 상태가 변경되었음을 안내 받아야 한다.  
- `clientDeleteProhibited`, `serverDeleteProhibited`: 객체 삭제 요청이 거절되어야 한다.
- `clientTransferProhibited`, `serverTransferProhibited`: 객체 이전 요청이 거절되어야 한다.
- `clientUpdateProhibited`, `serverUpdateProhibited`: ← 이 상태를 제거하는 것은 제외하고 호스트 업데이트 요청이 거절되어야 한다.  
  
#### 상태 별 결합

다음은 상태 결합에 대한 케이스이다. EPP 도메인 상태와 같이 명시적으로 금지되지않은 조합은 사용 가능하다.  
  
호스트객체와 동일하고, 여기에 `pendingTranfer`와 `clientTransferProhibited`, `serverTransferProhibited`는 결합될 수 없다는 케이스만 추가되면 된다.
  
  
---
## **4 Registry Grace Periods(유예 기간)**
도메인 만료 후에도 일정 기간 동안 도메인을 복원할 수 있는 시간을 의미한다.
아래에 정의된 크레딧에 대한 내용은 레지스트리와 등록기관(레지스트라) 사이에서 발생하는 크레딧을 의미한다.  

![](https://i.imgur.com/QcK4OvA.jpeg)
도메인 사이클에 대한 대략적인 그림을 참고해 보쟈  
  
### **4.1 Add Grace Period(등록 유예 기간)**
등록 유예 기간은 도메인을 처음 등록 후 5일동안의 기간을 의미한다. 5일 이내 삭제, 갱신, 이전 작업이 발생하면 아래 규칙을 따른다.  
  
**1. 삭제**
- AGP 기간 내 도메인을 삭제하면 [[#등록기관]]은 등록 수수료에 해당하는 크레딧이 환급된다. 도메인은 Identity Digital SRS DB에서 삭제되고 다른 레지스트라에서 즉시 등록이 가능하다.
- 5일의 유예 기간이 지나고 삭제하는 경우:
	- 30일 동안 복구 기간(redemptionPeriod) 상태가 된다. 이 때 복구하거나 삭제할 수 있다.
	- 이후 5일간 삭제 보류(pendingDelete) 상태가 된다.
	- redemptionPeriod 이내에 도메인을 복구하지 않으면 SRS에서 자동으로 삭제한다.
  
**2. 갱신**
- AGP 기간 내 도메인이 갱신되면 생성 트랜잭션에 대해 유예 기간 크레딧이 주어지지 않는다.
- 초기 등록 요금 외에도 레지스트라의 사용 가능한 크레딧은 갱신된 연수만큼 차감된다.
- 도메인의 만료일은 요청된 연수 만큼 업데이트되고, 최대 10년까지 가능하다.
  
**3. 이전**
- AGP 동안 도메인은 이전될 수 없다. Second-level 도메인 보유자는 처음 등록하는 5일 이내 레지스트라를 변경할 수 없다.
- 이 규정의 시행은 등록 기관의 책임이며, Identity Digital SRS는 자동으로 이 요구사항을 자동으로 시작한다.
  
### **4.2 Renew Grace Period(갱신 유예 기간)**
갱신 유예 기간은 도메인 이름 갱신 또는 연장 후 5일동안의 기간을 의미한다. 5일 이내 삭제, 갱신, 이전 작업이 발생하면 아래 규칙을 따른다.
  
아래 사항은 Renew Grace Period로 간주하지 않는다.
- 도메인이 먼저 삭제된 후 복구된 경우
- 유예기간 내에 승인 또는 자동 승인된 경우
  
**1. 삭제**
- 이 기간 내 도메인을 삭제하면 레지스트라는 도메인이 갱신된 연수에 따라 갱신 크레딧을 환급 받는다.
- 그러고 나서 삭제가 Add Grace Period 기간 내에 발생하지 않는 한 Redemption Grace Period(복구 유예 기간)에 들어가게 된다.
  
**2. 갱신**
- 도메인은 총 10년까지 Renew Grace Period 동안 갱신될 수 있다. 이 상태에서 유예 기간 크레딧은 제공되지 않는다.
- 도메인 만료일은 최대 10년으로 제한된다.
- 레지스트라에 등록된 크레딧은 갱신된 연수 만큼 차감된다.
  
**3. 이전**
- 이 기간 내 도메인이 이전되면 추가된 갱신 연수는 제거되지 않고, 유예 기간 크레딧도 제공되지 않는다.
- 성공적으로 레지스트라 이전이 완료되면 도메인 만료일은 1년 연장된다. 이전 받은 등록 기관은 이전에 대한 수수료를 Identity Digital에 지불한다.
  
### **4.3 Auto-Renew Grace Period(자동 갱신 유예 기간)**
배치 프로세스로 도메인 이름의 자동 갱신을 완료 후 45일 동안의 기간을 의미한다.
  
만약 레지스트라가 만료일 이전에 도메인 갱신을 하지 않으면, 레지스트리는 만료일 다음 날 자동으로 배치 프로세스를 통해 1년 연장한다. 이후 레지스트라는 45일 동안 도메인을 삭제할 수 있고 갱신 수수료에 대한 환불도 받을 수 있다.
  
**1. 삭제**
- 이 기간 동안 도메인이 삭제되면 레지스트라는 자동 갱신 수수료에 대해 크레딧을 받을 수 있다.
- 도메인은 30일동안 redemptionPeriod 상태가 된다. 이후 5일의 pendingDelete 상태가 된다.
- RedemptionPeriod 기간 내에 도메인을 복구하지 않으면 최종적으로 SRS에 의해 자동으로 삭제된다.
  
**2. 갱신**
- 도메인을 최대 10년까지 자동 갱신 유예 기간 동안 갱신할 수 있다. 이 기간 동안 유예 기간 크레딧은 제공되지 않는다. 도메인 만료일은 최대 10년으로 제한된다.
  
**3. 이전**
- 다른 레지스트라가 도메인 이전을 요청할 수 있다. 만약 도메인 이전이 이 기간 내에 승인되거나 자동 승인되면 이전된 레지스트라는 자동 갱신 수수료를 환급받을 수 있다.
  
### **4.4 Transfer Grace Period(이전 유예 기간)**

이전 유예 기간은 도메인 이름 이전 완료 후 5일동안의 기간을 의미한다.
  
아래 사항은 Transfer Grace Period로 간주하지 않는다.
- 도메인이 삭제되었다가 복구된 경우
- 유예기간 내에 도메인 이전이 승인 또는 자동 승인된 경우  
  
**1. 삭제**
- 이 기간 동안 도메인을 삭제하면 [[#sponsoring registrar]]는 등록 비용만큼의 크레딧을 받을 수 있다.
- 도메인은 redemptionPeriod 상태가 된다.  

**2. 갱신**
- 이 기간 동안 도메인을 갱신하면 이전에 대한 크레딧은 제공되지 않는다. 전송 비용 외에도 레지스트라의 사용가능한 크레딧은 등록된 갱신 연수만큼 차감된다.
- 도메인 만료일은 레지스트라의 요청된 갱신 작업에 명시된 연수만큼 갱신된다. 등록 기간의 최대치는 10년을 초과하지 않도록 제한된다.  
  
**3. 이전**
- 이전 유예 기간 동안 도메인이 또 다른 등록기관에 이전될 수 있다. 유예 기간 크레딧은 제공되지 않는다.
- 이전 받은 등록기관의 가용 크레딧은 이전 수수료만큼 차감된다.  
  
### **4.5 Redemption Grace Period(복구 유예 기간)**
  
Identity Digital SRS RGP 프로세스는 다른 레지스트리들도 사용하는 업계 표준을 따른다. RGP는 자동화된 복구 프로세스를 통해 제공되고, 레지스트라는 Restore Report을 작성해야 한다.  
  
RGP 목적은 도메인이 잘못 삭제된 경우 레지스트라가 **redeem(복구)** 할 수 있도록 도메인 이름 삭제 후 추가 기간을 제공하기 위함이다. RGP 정책은 다음 세가지 키 타임 기간을 포함한다.  

**1. Thirty(30) Day Redemption Grace Period(30일 복구 유예 기간)**
도메인 삭제 후 30일 동안 도메인은 **pendingDelete**상태가 된다. 이 기간 동안 도메인은 등록할 수 없고, 존 파일로부터 삭제될 것이다. 도메인은 작동하지 않고, WHOIS는 **pendingDelete - redemptionPeriod**상태로 보여줄 것이다.
레지스트라는 이 기간동안 언제든 복구할 수 있다. RGP를 통한 도메인 복구 요청은 레지스트라 계정에 환불되지 않는 요금을 부과한다.  
  
**2.  Five(5) Day Restore Lock Period(5일 복구 잠금 기간)**
만약 도메인이 복구되면 레지스트라는 정식 복구 레포트를 5일 이내 제출해야 한다. 레포트가 완전히 제출되면 제한적인 상태가 해제될 것이다.
5일 안에 레포트가 제출되지 않으면 도메인은 **pendingDelete** 상태로 돌아가고, RGP 사이클은 다시 시작된다.  
  
**3. Five(5) Day Redemption Hold Period(5일 복구 보류 기간)**
도메인이 30일 뒤에 복구되지 않으면 5일 동안 도메인의 상태를 변경할 수 없는 보류 기간에 들어간다. 이 기간이 끝나면 도메인은 삭제될 것이고, 사용가능한 도메인 pool에 릴리즈될 것이다. RGP 기간(30일)과 RHP(5일)에 포함되는 도메인 목록은 모든 레지스트라에게 매일 제공된다.  
  
#### 4.5.1 RGP 규칙
Redemption Grace Period(RGP)는 도메인이 명시적으로 삭제되면 적용된다. RGP는 레지스트라에게 변심이나 에러로 인해 삭제가 요청된 경우, 도메인을 복구할 수 있는 30일을 제공한다.
RGP 기간 동안 도메인은 존파일에서 제거 되고, WHOIS 정보는 "Pending Delete - Redemption Period"로 업데이트 된다. 이 상태에서는 도메인을 복구하거나 30일이 지나 레지스트리에 의해 삭제되는 것 외에 도메인에 대한 작업은 수행할 수 없다.
또한 이 기간 동안 도메인 이전은 불가능하다.

#### 4.5.2 복구 절차
도메인 복구 요청 방법: 
1. 레지스트라 web 포털
	1. 
2. EPP `<update>` 명령어과 RGP 확장 사용
	1. RFC 3915

절차:
1. 복구 요청이 접수되면, 복구 보고서 추가 제출까지 도메인은 임시 복구되고 레지스트라 계정에서 RGP 수수료가 차감된다.
2. 5일 동안 Restore Lock Period에 들어간다.
3. 레지스트라는 5일 안에 레지스트라 웹 포털이나 EPP를 통해 반드시 Restore Report를 제출해야 한다. 그게 아니라면 도메인은 Pending Delete 상태로 돌아갈 것이다.
4. 또한 이미 갱신된 상태에서 레지스트라에 의해 삭제된 도메인이 RGP 동안 복구되는 경우, 레지스트라 계정은 RGP 수수료와 갱신 수수료가 차감된다.

























---
# 용어 정리
###### 등록기관
- registrar를 의미한다.
###### sponsoring registrar
- 도메인을 A 등록기관(Registrar)에서 B 등록기관으로 이전할 때 현재 도메인을 관리하는 등록기관을 의미한다.

---
# 문서 외 직접 찾아본 것

- 레지스트라 환급: 도메인 삭제시 레지스트라는 도메인 등록 비용을 이미 ICANN이나 레지스트리에 지불했을 가능성이 있다. 하지만 도메인이 삭제되면 ICANN 규정에 따라 레지스트라가 지불한 등록 비용을 다시 돌려 받을 수 있다.
- 크레딧 사용 방식: 크레딧은 레지스트라 내부 시스템에 추가되어 다른 도메인 등록 작업이나 서비스 비용에 사용될 수 있다. 유예기간동안 몇 가지 정의된 상황에 따라 *레지스트라가 크레딧을 받는다*라고 명시되어 있는 것은 레지스트라의 금전적 손실을 방짛하기 위한 **비용 회수 메커니즘**이라 할 수 있다.